# 建筑修复逻辑测试

这是一个关键测试目录，包含用于验证游戏建筑修复逻辑的测试文件。

## 重要说明

⚠️ **这个tests目录里的测试为关键测试，只有在我特地说明的情况下才可以将测试移动到这个文件中，而且这里的测试不能被删除。**

## 测试文件

### 1. game_simulation_test.py
主要的游戏模拟测试文件，包含：
- 模拟地图（60x40瓦片）
- 半血的需要修复的箭塔
- 拥有500金币的主基地
- 工程师角色
- 可视化界面用于观察修复过程

### 2. run_repair_test.py
测试运行脚本，用于启动建筑修复逻辑测试。

## 测试场景

测试场景包含以下元素：

1. **主基地（地牢之心）**
   - 位置：(10, 10)
   - 金币：500
   - 血量：1000/1000
   - 状态：完全健康

2. **损坏的箭塔**
   - 位置：(25, 15)
   - 血量：100/200（半血）
   - 状态：损坏，需要修复
   - 修复成本：100金币

3. **工程师**
   - 位置：(12, 12)（靠近主基地）
   - 携带金币：0（初始）
   - 任务：自动修复损坏的箭塔

## 运行测试

### 方法1：直接运行测试文件
```bash
cd D:\GameProject\GameTest\tests
python game_simulation_test.py
```

### 方法2：使用运行脚本
```bash
cd D:\GameProject\GameTest\tests
python run_repair_test.py
```

## 测试控制

- **空格键**：手动触发工程师开始修复任务
- **ESC键**：退出测试
- **关闭窗口**：退出测试

## 测试验证点

测试会验证以下逻辑：

1. ✅ 工程师能够从主基地收集金币
2. ✅ 工程师能够移动到损坏的建筑
3. ✅ 工程师能够开始修复任务
4. ✅ 修复过程中金币正确消耗
5. ✅ 建筑血量正确恢复
6. ✅ 修复完成后建筑状态正确更新

## 可视化说明

- **红色建筑**：主基地（地牢之心）
- **黄色/红色建筑**：损坏的箭塔（根据血量显示颜色）
- **蓝色圆圈**：工程师
- **绿色/红色血条**：建筑血量指示器
- **黄色文字**：工程师携带的金币数量

## 测试日志

测试过程中会在控制台输出详细的日志信息，包括：
- 测试阶段变化
- 工程师任务状态
- 建筑修复进度
- 金币消耗情况
- 错误和异常信息

## 预期结果

成功的测试应该显示：
1. 工程师从主基地收集100金币
2. 工程师移动到箭塔位置
3. 工程师开始修复箭塔
4. 箭塔血量从100恢复到200
5. 箭塔状态从"损坏"变为"完成"
6. 主基地剩余金币为400

如果测试失败，会显示失败原因分析。
